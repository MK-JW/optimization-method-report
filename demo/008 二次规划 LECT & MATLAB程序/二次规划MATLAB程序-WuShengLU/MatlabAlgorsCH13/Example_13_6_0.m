%椭球法法程序求解有约束问题最优解Example13.6
 x0=[4;-1];
 A0=[36,0;0,9];
 x1=x0(1,1);x2=x0(2,1);
 maxk=5000;
 epsilon=1e-7;
 k=0;
 while (k<maxk)
   if(2*x1-x2-6>=0&&-2*x1-x2+10>=0&&-3*x1+x2+15>=0&&3*x1+x2-9>=0)
      gk=[2*(x1-5*x2+4)+28*(7*x1+11*x2-18)^3;-10*(x1-5*x2+4)+44*(7*x1+11*x2-18)^3];
       gk1=gk/sqrt(gk'*A0*gk);
     gammak=sqrt(gk'*A0*gk);
     if(gammak<epsilon)        
         break; 
     end
     x0=x0-A0*gk1/3;
     A0=4/3*(A0-2/3*A0*(gk1*gk1')*A0);
   else
     cj=min([2*x1-x2-6,-2*x1-x2+10,-3*x1+x2+15,3*x1+x2-9]);
     if(cj==2*x1-x2-6)
          hk=[-2;1];
     elseif(cj==-2*x1-x2+10)
               hk=[2;1];
     elseif(cj==-3*x1+x2+15)
               hk=[3;-1];
     elseif(cj==3*x1+x2-9)
               hk=[-3;-1];
     end
     gk1=hk/sqrt(hk'*A0*hk); 
     if(cj+sqrt(hk'*A0*hk)<0)
           break;
      end
      x0=x0-A0*gk1/3;
      A0=4/3*(A0-2/3*A0*(gk1*gk1')*A0);
   end    
  k=k+1;x1=x0(1,1);x2=x0(2,1);
 end
 disp(x0);
